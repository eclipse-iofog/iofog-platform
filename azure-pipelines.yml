trigger:
- master
- develop

pool:
  vmImage: 'ubuntu-16.04'

steps:
- task: UsePythonVersion@0
  inputs:
    versionSpec: '2.7'
    architecture: 'x64'

- script: pip install -r requirements.txt
  displayName: 'Install Python requirements'

- script: |
    python cli.py up iofog --local
  displayName: 'Deploy ioFog locally'
#- script: |
#    echo $(gcp.svc) > plugins/gcp/creds/svcacc.json
#    cat plugins/gcp/creds/svcacc.json
#    python cli.py up gcp --bootstrap=true
#  displayName: 'Deploy GCP Cluster and Agents'

#- script: |
#    python cli.py up iofog --bootstrap=true
#  displayName: 'Deploy ioFog Kubernetes and ioFog Agents'

- script: |
    python cli.py test iofog
  displayName: 'Test ioFog'

#- script: |
#    python cli.py down gcp
#  displayName: 'Tear GCP down'
#  condition: always()